# 单聊概述

## 概述

单聊是融云 IM 服务中最基础的通信方式，支持两个用户之间的一对一私密聊天。

## 功能特性

### 基础功能
- **一对一聊天**：支持两个用户之间的私密对话
- **多种消息类型**：支持文本、图片、语音、视频、文件等多种消息类型
- **消息存储**：支持消息的持久化存储和历史记录查询
- **实时推送**：支持消息的实时推送和离线通知

### 高级功能
- **消息状态**：支持消息的发送状态跟踪
- **已读回执**：支持消息的已读状态确认
- **消息撤回**：支持已发送消息的撤回功能
- **黑名单**：支持用户黑名单管理

## 使用场景

### 个人聊天
- 好友之间的日常交流
- 客服与用户的咨询对话
- 导师与学员的指导交流

### 商务沟通
- 同事之间的工作交流
- 合作伙伴的业务洽谈
- 客户与销售的业务咨询

### 社交应用
- 社交平台的好友聊天
- 婚恋应用的私信功能
- 游戏应用的私聊系统

## 技术架构

### 消息流程
1. **消息发送**：用户A发送消息到融云服务器
2. **消息处理**：服务器进行消息格式验证和内容审核
3. **消息转发**：服务器将消息转发给用户B
4. **消息存储**：服务器将消息存储到数据库
5. **推送通知**：如果用户B离线，发送推送通知

### 连接管理
- **长连接**：使用 WebSocket 保持实时连接
- **断线重连**：支持自动断线重连机制
- **多端同步**：支持多端登录和消息同步

## 消息类型

### 文本消息
- 纯文本内容
- 支持表情符号
- 支持富文本格式

### 媒体消息
- 图片消息
- 语音消息
- 视频消息
- 文件消息

### 位置消息
- 地理位置信息
- 位置描述
- 坐标信息

### 自定义消息
- 业务自定义消息
- 结构化数据
- 扩展字段支持

## 安全机制

### 消息加密
- 端到端加密
- 传输层加密
- 存储层加密

### 权限控制
- 用户身份验证
- 消息访问权限
- 黑名单机制

### 内容审核
- 文本内容审核
- 图片内容审核
- 视频内容审核

## 性能指标

### 消息延迟
- 平均延迟：< 100ms
- 99% 消息延迟：< 200ms
- 最大延迟：< 500ms

### 消息可靠性
- 消息送达率：> 99.9%
- 消息丢失率：< 0.1%
- 消息重复率：< 0.01%

### 并发能力
- 单用户并发：1000+
- 系统总并发：100万+
- 消息吞吐量：10万+/秒

## 最佳实践

### 1. 消息发送
- 合理控制消息发送频率
- 优化消息内容大小
- 使用合适的消息类型

### 2. 用户体验
- 提供消息发送状态反馈
- 实现消息已读回执
- 支持消息撤回功能

### 3. 性能优化
- 实现消息分页加载
- 使用消息缓存机制
- 优化网络请求策略

### 4. 安全考虑
- 实现消息内容审核
- 保护用户隐私信息
- 防止恶意消息攻击

## 相关接口

- [发送单聊消息](/api/im/message/private/publish)
- [获取历史消息](/api/im/message/history)
- [设置消息已读](/api/im/message/read)
- [撤回消息](/api/im/message/recall) 