# 内容审核概述

## 概述

内容审核是融云 IM 服务中的重要安全功能，用于检测和过滤不当内容，保护用户安全和平台健康。

## 功能特性

### 基础功能
- **文本审核**：检测文本中的敏感词、违规内容
- **图片审核**：识别图片中的违规、色情、暴力内容
- **视频审核**：检测视频中的违规内容
- **实时审核**：消息发送时实时进行内容审核

### 高级功能
- **自定义词库**：支持自定义敏感词库
- **审核策略**：支持灵活的审核策略配置
- **审核结果**：提供详细的审核结果和置信度
- **批量审核**：支持批量内容审核

## 审核类型

### 文本审核
- **敏感词检测**：检测文本中的敏感词汇
- **违规内容检测**：检测违规、违法内容
- **垃圾信息检测**：检测垃圾广告、诈骗信息
- **政治敏感检测**：检测政治敏感内容

### 图片审核
- **色情内容检测**：识别色情、成人内容
- **暴力内容检测**：识别暴力、血腥内容
- **政治敏感检测**：识别政治敏感图片
- **广告内容检测**：识别违规广告图片

### 视频审核
- **视频内容检测**：检测视频中的违规内容
- **视频封面检测**：检测视频封面图片
- **视频时长限制**：限制视频时长和大小
- **视频格式验证**：验证视频格式和编码

## 审核策略

### 审核级别
- **严格模式**：最严格的审核标准，误杀率较高
- **标准模式**：平衡的审核标准，推荐使用
- **宽松模式**：较宽松的审核标准，漏检率较高

### 处理方式
- **拦截**：直接拦截违规内容
- **替换**：将敏感词替换为 ***
- **标记**：标记为待人工审核
- **通过**：直接通过审核

### 自定义配置
```javascript
// 配置审核策略
const auditConfig = {
  textAudit: {
    level: 'standard', // strict, standard, loose
    action: 'block', // block, replace, mark, pass
    customKeywords: ['自定义敏感词1', '自定义敏感词2']
  },
  imageAudit: {
    level: 'standard',
    action: 'block',
    enableOCR: true // 启用OCR文字识别
  },
  videoAudit: {
    level: 'standard',
    action: 'block',
    maxDuration: 300, // 最大时长（秒）
    maxSize: 100 * 1024 * 1024 // 最大大小（字节）
  }
};
```

## 审核流程

### 实时审核
1. **消息发送**：用户发送消息
2. **内容提取**：提取消息内容
3. **审核检测**：调用审核服务
4. **结果处理**：根据审核结果处理
5. **消息发送**：发送或拦截消息

### 批量审核
1. **内容收集**：收集待审核内容
2. **批量处理**：批量调用审核服务
3. **结果统计**：统计审核结果
4. **结果处理**：处理审核结果

## 审核结果

### 审核状态
- **pass**：审核通过
- **block**：审核拦截
- **review**：需要人工审核
- **error**：审核出错

### 置信度
- **high**：高置信度（> 90%）
- **medium**：中等置信度（60-90%）
- **low**：低置信度（< 60%）

### 结果示例
```json
{
  "code": 200,
  "result": {
    "status": "block",
    "confidence": 0.95,
    "reason": "包含敏感词",
    "details": {
      "keywords": ["敏感词1", "敏感词2"],
      "suggestion": "请修改内容后重新发送"
    }
  }
}
```

## 使用场景

### 社交平台
- 用户聊天内容审核
- 群组消息审核
- 评论内容审核

### 直播平台
- 直播间聊天审核
- 用户昵称审核
- 礼物消息审核

### 游戏平台
- 游戏内聊天审核
- 公会消息审核
- 世界聊天审核

### 企业应用
- 内部沟通审核
- 客户服务审核
- 会议记录审核

## 最佳实践

### 1. 审核策略
- 根据业务场景选择合适的审核级别
- 定期更新敏感词库
- 配置合理的处理方式

### 2. 用户体验
- 提供清晰的审核提示
- 支持内容修改和重新发送
- 建立申诉机制

### 3. 性能优化
- 使用异步审核处理
- 实现审核结果缓存
- 优化审核响应时间

### 4. 安全考虑
- 保护用户隐私信息
- 建立审核日志记录
- 定期审查审核策略

## 错误处理

### 常见错误
- 审核服务不可用
- 审核超时
- 内容格式错误
- 审核配额超限

### 错误处理
```javascript
// 处理审核错误
function handleAuditError(error) {
  switch (error.code) {
    case 'SERVICE_UNAVAILABLE':
      // 审核服务不可用，可以选择通过或拦截
      return 'block';
    case 'TIMEOUT':
      // 审核超时，可以选择通过或拦截
      return 'pass';
    case 'QUOTA_EXCEEDED':
      // 审核配额超限
      console.error('审核配额超限');
      return 'block';
    default:
      // 其他错误
      console.error('审核错误:', error);
      return 'block';
  }
}
```

## 监控告警

### 监控指标
- 审核成功率
- 审核响应时间
- 审核拦截率
- 审核错误率

### 告警设置
- 审核服务异常告警
- 审核成功率下降告警
- 审核响应时间超时告警
- 审核配额不足告警

## 相关接口

- [文本审核](/api/im/content/text/audit)
- [图片审核](/api/im/content/image/audit)
- [视频审核](/api/im/content/video/audit)
- [自定义词库管理](/api/im/content/keywords) 